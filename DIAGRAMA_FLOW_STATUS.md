# ğŸ“Š Diagrama do Sistema de Flow Status

## ğŸ”„ Fluxo Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PROCESSO SELETIVO                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [Candidato em Qualquer Fase]
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  RH arrasta para    â”‚
    â”‚    "APROVADO"       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       ğŸ¯ MODAL APARECE AUTOMATICAMENTE       â”‚
    â”‚                                              â”‚
    â”‚  "Qual o status atual desta vaga?"          â”‚
    â”‚                                              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚  â”‚  â—‹ ATIVA                           â”‚    â”‚
    â”‚  â”‚    â†’ Vaga continua no site         â”‚    â”‚
    â”‚  â”‚    â†’ Aceita novos candidatos       â”‚    â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â”‚                                              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚  â”‚  â—‹ CONCLUÃDA                       â”‚    â”‚
    â”‚  â”‚    â†’ Vaga sai do site              â”‚    â”‚
    â”‚  â”‚    â†’ Todas as posiÃ§Ãµes preenchidas â”‚    â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â”‚                                              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚  â”‚  â—‹ CONGELADA                       â”‚    â”‚
    â”‚  â”‚    â†’ Vaga sai do site              â”‚    â”‚
    â”‚  â”‚    â†’ Temporariamente pausada       â”‚    â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â”‚                                              â”‚
    â”‚         [Cancelar]  [Confirmar]             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Sistema atualiza:  â”‚
    â”‚  1. Status candidatoâ”‚
    â”‚  2. Flow da vaga    â”‚
    â”‚  3. Cria nota       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           RESULTADO NO SISTEMA               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚              â”‚              â”‚              â”‚
         [ATIVA]        [CONCLUÃDA]    [CONGELADA]
              â”‚              â”‚              â”‚
    âœ… Aparece      âŒ NÃ£o aparece  âŒ NÃ£o aparece
    no site pÃºblico   no site         no site
              â”‚              â”‚              â”‚
    âœ… Aceita novos âœ… Processo    âœ… Processo
    candidatos      completo         pausado
```

---

## ğŸ¨ Estados Visuais

### No Admin (GestÃ£o de Vagas):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vaga              | Status                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Analista de RH    | [Ativa] ğŸŸ¢                         â”‚
â”‚ 1 vaga disponÃ­vel |                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Agente Comercial  | [Ativa] ğŸŸ¢                         â”‚
â”‚ 5/5 vagas         | [âœ“ ConcluÃ­da] ğŸ”µ                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Desenvolvedor     | [Ativa] ğŸŸ¢                         â”‚
â”‚ 2 vagas           | [â¸ Congelada] ğŸŸ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### No Site PÃºblico:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         VAGAS DISPONÃVEIS                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Analista de RH                       â”‚
â”‚    (flow_status = 'ativa')              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âŒ Agente Comercial                     â”‚
â”‚    (flow_status = 'concluida')          â”‚
â”‚    â†’ NÃƒO APARECE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âŒ Desenvolvedor                        â”‚
â”‚    (flow_status = 'congelada')          â”‚
â”‚    â†’ NÃƒO APARECE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Queries de ValidaÃ§Ã£o

### 1. Verificar configuraÃ§Ã£o correta:

```sql
-- Ver todas as vagas e seus status
SELECT 
  title,
  status,
  approval_status,
  flow_status,
  CASE 
    WHEN status = 'active' 
      AND approval_status = 'active' 
      AND flow_status = 'ativa' 
    THEN 'âœ… VISÃVEL NO SITE'
    ELSE 'âŒ NÃƒO VISÃVEL'
  END as visibilidade_publica
FROM jobs
ORDER BY created_at DESC;
```

### 2. Simular query do site pÃºblico:

```sql
-- Esta Ã© exatamente a query que o site pÃºblico executa
SELECT * 
FROM jobs
WHERE status = 'active'
  AND approval_status = 'active'
  AND flow_status = 'ativa'
ORDER BY created_at DESC;
```

### 3. Ver histÃ³rico de mudanÃ§as:

```sql
-- Ver notas de candidatos aprovados
SELECT 
  c.name as candidato,
  j.title as vaga,
  cn.note,
  cn.created_at
FROM candidate_notes cn
JOIN candidates c ON c.id = cn.candidate_id
JOIN jobs j ON j.id = c.job_id
WHERE cn.activity_type = 'AprovaÃ§Ã£o'
ORDER BY cn.created_at DESC
LIMIT 10;
```

---

## ğŸ¯ CenÃ¡rios de Uso Real

### CenÃ¡rio 1: Vaga com 1 posiÃ§Ã£o
```
RH aprova candidato â†’ Modal â†’ Seleciona "ConcluÃ­da"
â†’ Vaga some do site
â†’ Processo finalizado
```

### CenÃ¡rio 2: Vaga com 5 posiÃ§Ãµes
```
RH aprova candidato 1 â†’ Modal â†’ Seleciona "Ativa"
â†’ Vaga continua no site (4 vagas restantes)

RH aprova candidato 2 â†’ Modal â†’ Seleciona "Ativa"
â†’ Vaga continua no site (3 vagas restantes)

...

RH aprova candidato 5 â†’ Modal â†’ Seleciona "ConcluÃ­da"
â†’ Vaga some do site (todas preenchidas)
```

### CenÃ¡rio 3: Processo pausado temporariamente
```
RH precisa pausar processo â†’ Edita vaga â†’ "Congelada"
â†’ Vaga some do site
â†’ Candidatos atuais continuam no processo
â†’ Quando retomar: Edita vaga â†’ "Ativa"
â†’ Vaga volta para o site
```

---

## âš¡ Testes de Performance

### Query de Performance:

```sql
-- Verificar se o Ã­ndice estÃ¡ sendo usado
EXPLAIN ANALYZE
SELECT * 
FROM jobs
WHERE status = 'active'
  AND approval_status = 'active'
  AND flow_status = 'ativa';
```

**Resultado Esperado**:
- âœ… Deve usar `idx_jobs_flow_status`
- âœ… Tempo < 50ms para atÃ© 1000 vagas

---

## ğŸ”’ Testes de SeguranÃ§a

### 1. UsuÃ¡rio nÃ£o autenticado:
```
Tentar acessar vaga concluÃ­da via URL direta:
â†’ /vaga/{uuid-da-vaga-concluida}

Resultado Esperado: "Vaga nÃ£o encontrada"
```

### 2. RH sem permissÃ£o regional:
```
Tentar editar vaga de outra regiÃ£o:
â†’ NÃ£o deve aparecer na lista
â†’ NÃ£o deve permitir ediÃ§Ã£o
```

---

## ğŸ“± Testes de Responsividade

### Desktop (1920x1080):
- âœ… Modal centralizado
- âœ… Badges visÃ­veis
- âœ… FormulÃ¡rio de ediÃ§Ã£o completo

### Tablet (768x1024):
- âœ… Modal adapta largura
- âœ… Badges empilhados se necessÃ¡rio

### Mobile (375x667):
- âœ… Modal ocupa 90% da tela
- âœ… BotÃµes empilhados verticalmente
- âœ… Badges responsivos

---

## ğŸš€ Checklist de Deploy

Antes de fazer `git add .`:

1. **Testes Funcionais**
   - [ ] TESTE 1: Modal aparece âœ…
   - [ ] TESTE 2: Status atualiza âœ…
   - [ ] TESTE 3: Vaga concluÃ­da nÃ£o aparece âŒ
   - [ ] TESTE 4: Vaga congelada nÃ£o aparece âŒ
   - [ ] TESTE 5: Vaga ativa aparece âœ…
   - [ ] TESTE 6: Admin vÃª todas âœ…
   - [ ] TESTE 7: EdiÃ§Ã£o manual funciona âœ…
   - [ ] TESTE 8: Vaga nova = ativa âœ…
   - [ ] TESTE 9: MÃºltiplas aprovaÃ§Ãµes âœ…
   - [ ] TESTE 10: Compatibilidade âœ…

2. **Testes TÃ©cnicos**
   - [ ] Sem erros de TypeScript
   - [ ] Sem erros de lint
   - [ ] Build executado (`npm run build`)
   - [ ] Preview testado (`npm run preview`)

3. **Testes de Banco**
   - [ ] MigraÃ§Ã£o aplicada
   - [ ] Enum criado
   - [ ] Ãndice criado
   - [ ] FunÃ§Ã£o atualizada

4. **Testes de UX**
   - [ ] Modal intuitivo
   - [ ] Mensagens claras
   - [ ] Badges bem posicionados
   - [ ] Sem travamentos

---

## ğŸ‰ Resultado Final Esperado

ApÃ³s todos os testes:

âœ… **Site PÃºblico**: Mostra apenas vagas ativas
âœ… **Admin**: Controle total sobre visibilidade
âœ… **UX**: Modal intuitivo quando candidato Ã© aprovado
âœ… **Performance**: Queries otimizadas com Ã­ndice
âœ… **Compatibilidade**: Funciona com vagas antigas
âœ… **SeguranÃ§a**: RLS mantido em todas as operaÃ§Ãµes
